---
title: 달고나 문서 공부
---

### 해커 지망자들이 알아야 할 Buffer Overflow Attack의 기초


Buffer Overflow 공격은 오래 전에 발표된 기술이지만 아직까지도 많이 사용되는 기술이다. 그 이유는 무엇보다 buffer overflow 공격에 취약한 프로그램이 많이 만들어지고 있기 때문이다.

"Overflow" 라는 단어의 사전적 의미는 강물이 범람하다 또는 넘쳐 흐르다 라는 의미를 가지고 있다. 버퍼 오버플로우는 데이터를 버퍼에 저장할 때 버퍼를 채운 뒤에 흘러 넘쳐 이후의 공간까지도 침범하여 다른 공간의 값을 덮어쓰게 되는 것이다. 중대한 버그이자 프로그램의 취약점으로 여겨진다.

특히, 버퍼 오버플로우에 취약한 함수들이 존재한다. 우리가 흔히 사용하는 scanf나 gets 같은 함수들도 처리하는 문자열의 크기를 지정하지 않아 버퍼 오버플로우 공격에 매우 취약하다. 그러므로 버퍼 오버플로우에 취약한 함수들을 대체하는 보안이 강화된 함수들을 사용하는 것이 바람직하다.

![image](https://user-images.githubusercontent.com/69578124/92227991-1d4fa580-eee2-11ea-9b56-c990aaf8664d.png)

이제 우리가 알아야 하는 부분은 하나의 프로그램이 실행되기 위해 움직이는 메모리의 구조다. 운영체제는 하나의 프로그램, 즉 프로세스를 실행시키면 이 프로세스를 세그먼트 segment 라는 단위로 묶어서 가용 메모리 영억에 저장시킨다. 이것은 위의 그림과 같다.

오늘날의 시스템은 멀티태스킹이 가능하므로 메모리에는 여러 개의 프로세스가 저장되어 병렬적으로 작업을 수행한다. 하나의 세그먼트는 code segment, data segment, stack segment라고 한다. 시스템에는 최대 16,383개의 segment가 생성될 수 있고, 하나의 segment는 최대 2^32byte의 크기를 가질 수 있다.

> code segment:
시스템이 알아듣는 명령어(instructions)이 들어있다. 기계어 코드로서 컴파일러가 만들어 낸 코드이며 이 명령어들은 많은 분기 과정과 점프, 시스템 호출 등을 수행한다.
 분기와 점프의 경우 메모리 상의 특정 위치의 명령을 지정해주어야 하는데 segment는 자신이 메모리의 어디에 저장될지 컴파일 과정에서는 알 수 없으므로 정확한 주소를 지정할 수 없다.

그래서 segment는 위의 이유로 logical address를 사용하는데, 이는 실제 메모리 상의 주소와 매핑되어 있다.

> data segment:
프로그램 실행시에 들어가는 데이터가 들어간다.(전역 변수) 프로그램 내에서 전역 변수를 선언하면 그 변수가 data segment에 자리잡게 된다. data segment는 다시 4개의 data segment로 나뉘는데 각각 data structure, 상위 모듈로부터 받아들이는 데이터 모듈, 동적 생성 데이터, 다른 프로그램과 공유하는 공유 데이터 부분이다.

> stack segmet:
현재 수행되고 있는 handler, task, program이 저장하는 데이터 영역으로 우리가 사용하는 버퍼가 바로 이 세그먼트에 자리잡는다. 지역 변수들이 자리잡는 공간이다. 




